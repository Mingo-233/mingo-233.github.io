var m=Object.defineProperty;var l=(i,e,t)=>e in i?m(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var s=(i,e,t)=>(l(i,typeof e!="symbol"?e+"":e,t),t);import{d as p,B as u,H as _,S as w,C as g,R as x,q as h,r as c,e as d,A as b,P as v,s as B,k as S}from"./index-31c0b642.js";import{C as f,a as M}from"./CSS2DRenderer-0c9f38fe.js";import{t as y}from"./tweakpane-9ec2a9db.js";import{d as z,h as E,l as C,c as k,o as L,p as R,e as j,a as D}from"./index-42613d43.js";import{_ as P}from"./vendor-c27b6911.js";import"./LoadingCreator-28297c1b.js";let A=()=>{};class I{constructor(e){s(this,"basic");s(this,"scene");s(this,"camera");s(this,"renderer");s(this,"css2dRender");s(this,"css3dRender");s(this,"controls");s(this,"sizes");s(this,"useShader",!0);s(this,"clock");s(this,"helper");s(this,"debug");s(this,"resources");s(this,"emitter");s(this,"option");s(this,"material");s(this,"earthBox");s(this,"moonBox");this.option=e,this.emitter=new p.EventEmitter,this.basic=new u(e.dom),this.scene=this.basic.scene,this.renderer=this.basic.renderer,this.controls=this.basic.controls,this.camera=this.basic.camera,this.helper=new _(this.scene),this.sizes=new w(this),this.clock=new g,this.debug=new y.Pane({title:"🎉 mingo 🎉",expanded:!0}),this.resources=new x({textures:[{name:"start_bg",path:"./lib/earth/starts.jpg"},{name:"earth_atmos",path:"./lib/earth/earth_atmos_2048.jpg"},{name:"earth_normal",path:"./lib/earth/earth_normal_2048.jpg"},{name:"earth_specular",path:"./lib/earth/earth_specular_2048.jpg"},{name:"moon_1024",path:"./lib/earth/moon_1024.jpg"}]},()=>{this.initialize(),console.log("资源加载完成",this.resources),this.createEarth(),this.createMoon(),this.createLight(),this.createTagByCss2D("earth",this.earthBox),this.createTagByCss2D("moon",this.moonBox,2),this.controls.update(),this.render()})}initialize(){this.scene.background=this.resources.textures.start_bg,this.camera.position.set(30,10,30),this.renderer.shadowMap.enabled=!0,this.emitter.on("resize",()=>{this.renderer.setSize(Number(this.sizes.viewport.width),Number(this.sizes.viewport.height)),this.camera.aspect=Number(this.sizes.viewport.width)/Number(this.sizes.viewport.height),this.camera.updateProjectionMatrix()})}createEarth(){const e=new h(3,16,16),t=new c({map:this.resources.textures.earth_atmos,normalMap:this.resources.textures.earth_normal,specularMap:this.resources.textures.earth_specular}),r=new d(e,t);r.receiveShadow=!0,this.earthBox=r,this.scene.add(r)}createMoon(){const e=new h(.5,16,16),t=new c({map:this.resources.textures.moon_1024}),r=new d(e,t);r.castShadow=!0,r.position.setX(10),this.moonBox=r,this.scene.add(r)}createLight(){const e=new b(4210752,1);this.scene.add(e),new v(16777215,2,0).position.set(20,40,15);const r=new B(16777215,2);r.castShadow=!0,r.position.set(0,0,30),this.scene.add(r)}run(){let e=new S(0,1,0),t=this.clock.getDelta(),r=this.clock.getElapsedTime();this.moonBox.position.set(Math.sin(r)*10,0,Math.cos(r)*10),this.earthBox.rotateOnAxis(e,t*Math.PI/10),this.moonBox.rotateOnWorldAxis(e,t*-Math.PI/10)}createTagByCss2D(e,t,r=5){if(!this.css2dRender){let o=new f;o.setSize(window.innerWidth,window.innerHeight),o.domElement.style.position="absolute",o.domElement.style.top="0px",this.css2dRender=o,this.option.dom.appendChild(o.domElement)}var a=document.createElement("div");a.className="label",a.textContent=e;let n=new M(a);console.log(t.position),n.position.set(0,r,0),t.add(n)}destory(){window.removeEventListener("mousemove",A),this.debug.dispose()}render(){requestAnimationFrame(this.render.bind(this)),this.renderer.render(this.scene,this.camera),this.run(),this.css2dRender&&this.css2dRender.render(this.scene,this.camera)}}const N=i=>(R("data-v-f9aa680d"),i=i(),j(),i),T=N(()=>D("div",{id:"threejs-canvas"},null,-1)),q=[T],H=z({__name:"index",setup(i){let e;return E(()=>{const t=document.querySelector("#threejs-canvas");e=new I({dom:t})}),C(()=>{e.destory()}),(t,r)=>(L(),k("div",null,q))}});const J=P(H,[["__scopeId","data-v-f9aa680d"]]);export{J as default};
